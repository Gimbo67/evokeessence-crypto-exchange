import{b as m,r as x,d as j,j as e,C as y,N as g,O as f,Q as C,e as w,I as b,f as L,B as N,a5 as S}from"./index-DzUQlMCL.js";import{T,a as v,b as i,c as n,d as _,e as a}from"./table-CxCbk9gb.js";import{E as k}from"./layout-D-IzPikD.js";import{S as E}from"./search-BvG8QWW9.js";import{E as B}from"./external-link-yJkabYVq.js";import"./settings-C3McDjct.js";import"./log-out-DkZZLLuv.js";import"./file-text-xMDIOZi1.js";function Q(){const t=m(),[o,h]=x.useState(""),{data:p=[],isLoading:u}=j({queryKey:["/api/employee/clients"],queryFn:async()=>{try{console.log("Attempting to fetch clients via bypass endpoint");const s=await fetch("/bypass/employee/clients",{credentials:"include"});if(console.log("Bypass endpoint response status:",s.status),console.log("Bypass endpoint content type:",s.headers.get("Content-Type")),s.ok){const l=s.headers.get("Content-Type");if(l&&l.includes("application/json")){const c=await s.json();return console.log("Successfully fetched clients via bypass endpoint:",c.length),c}else console.warn("Bypass endpoint returned non-JSON content:",l)}console.log("Attempting regular endpoint");const r=await fetch("/api/employee/clients",{credentials:"include"});if(console.log("Regular endpoint response status:",r.status),console.log("Regular endpoint content type:",r.headers.get("Content-Type")),!r.ok)throw new Error("Failed to fetch clients");return r.json()}catch(s){throw console.error("Error fetching clients:",s),s}}}),d=p.filter(s=>{var r,l,c;return s.username.toLowerCase().includes(o.toLowerCase())||s.email.toLowerCase().includes(o.toLowerCase())||((r=s.fullName)==null?void 0:r.toLowerCase().includes(o.toLowerCase()))||((l=s.phoneNumber)==null?void 0:l.toLowerCase().includes(o.toLowerCase()))||((c=s.country)==null?void 0:c.toLowerCase().includes(o.toLowerCase()))});return e.jsx(k,{children:e.jsx("div",{className:"container py-6",children:e.jsxs(y,{children:[e.jsxs(g,{children:[e.jsx(f,{children:t("clients")||"Clients"}),e.jsx(C,{children:t("dashboard_manage_clients")||"Manage client accounts and permissions"})]}),e.jsxs(w,{children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx(E,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(b,{placeholder:t("search_clients")||"Search clients...",value:o,onChange:s=>h(s.target.value),className:"pl-8"})]}),e.jsxs(T,{children:[e.jsx(v,{children:e.jsxs(i,{children:[e.jsx(n,{children:t("username")}),e.jsx(n,{children:t("email")}),e.jsx(n,{children:t("full_name")}),e.jsx(n,{children:t("phone")}),e.jsx(n,{children:t("country")}),e.jsx(n,{children:t("kyc_status")}),e.jsx(n,{children:t("created_at")}),e.jsx(n,{className:"text-right",children:t("details")})]})}),e.jsx(_,{children:u?e.jsx(i,{children:e.jsxs(a,{colSpan:8,className:"text-center",children:[t("loading"),"..."]})}):d.length===0?e.jsx(i,{children:e.jsx(a,{colSpan:8,className:"text-center",children:t("no_clients_found")})}):d.map(s=>e.jsxs(i,{children:[e.jsx(a,{children:s.username}),e.jsx(a,{children:s.email}),e.jsx(a,{children:s.fullName}),e.jsx(a,{children:s.phoneNumber||"-"}),e.jsx(a,{children:s.country||"-"}),e.jsx(a,{children:e.jsx(L,{variant:s.kycStatus==="approved"?"default":s.kycStatus==="rejected"?"destructive":"secondary",children:t(`kyc_${s.kycStatus}`)})}),e.jsx(a,{children:new Date(s.createdAt).toLocaleDateString()}),e.jsx(a,{className:"text-right",children:e.jsx(N,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(S,{href:`/employee/clients/${s.id}`,children:[e.jsx(B,{className:"h-4 w-4 mr-1"}),t("view_details")]})})})]},s.id))})]})]})]})})})}export{Q as default};
