import{h as D,r as u,j as e,C as c,N as d,O as o,aV as S,e as m,S as n,M as T,aW as E,b5 as F,Q as g,ak as v}from"./index-DzUQlMCL.js";import{E as k}from"./layout-D-IzPikD.js";import{R as I,B as _,C as K,X as R,Y as b,T as L,b as w}from"./BarChart-BJux3iWp.js";import{A as O}from"./activity-EH2qfgKr.js";import"./settings-C3McDjct.js";import"./log-out-DkZZLLuv.js";import"./file-text-xMDIOZi1.js";const A={totalClients:0,activeClients:0,pendingKyc:0,totalTransactions:0,pendingTransactions:0,recentDeposits:0,dailyAmount:"0",permissions:{},recentActivity:[],chartData:[]};function X(){const{toast:h}=D(),[l,f]=u.useState(!0),[t,C]=u.useState(A),[y,N]=u.useState([]),x=s=>!!(y.includes(s)||t.permissions&&t.permissions[s]);u.useEffect(()=>{(async()=>{try{f(!0);const[a,i]=await Promise.allSettled([v.get("/bypass/employee/dashboard/permissions"),v.get("/bypass/employee/dashboard/stats")]);if(a.status==="fulfilled"&&a.value.data.permissions){const r=a.value.data.permissions;typeof r=="object"&&!Array.isArray(r)?N(Object.keys(r).filter(j=>r[j]===!0)):Array.isArray(r)&&N(r)}else console.warn("Could not load permissions data:",a.status==="rejected"?a.reason:"Invalid data format");if(i.status==="fulfilled"&&i.value.data){console.log("Stats response:",i.value.data);const r=i.value.data.stats||i.value.data;if(r){const j={...A,...r,chartData:r.chartData||[],recentActivity:r.recentActivity||[],permissions:r.permissions||{}};C(j)}else console.warn("Stats data is empty or in unexpected format"),h({title:"Warning",description:"Could not load complete dashboard data",variant:"default"})}else console.error("Failed to load stats data:",i.status==="rejected"?i.reason:"Invalid data format"),h({title:"Error",description:"Failed to load dashboard data",variant:"destructive"})}catch(a){console.error("Error in dashboard data fetch:",a),h({title:"Error",description:"Failed to load dashboard data",variant:"destructive"})}finally{f(!1)}})()},[h]);const p=s=>{if(s==null)return"$0.00";const a=typeof s=="string"?parseFloat(s):s;return isNaN(a)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a)};return e.jsx(k,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Employee Dashboard"}),e.jsxs("p",{className:"text-muted-foreground",children:["Welcome to your dashboard. You currently have access to:",e.jsx("span",{className:"font-medium",children:t.permissions?Object.keys(t.permissions).filter(s=>t.permissions[s]===!0).map(s=>s.replace(/_/g," ")).join(", "):y.join(", ")})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[x("view_clients")&&e.jsxs(c,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Total Clients"}),e.jsx(S,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(m,{children:l?e.jsx(n,{className:"h-8 w-20"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.totalClients}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t.activeClients," active clients"]})]})})]}),x("change_kyc_status")&&e.jsxs(c,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Pending KYC"}),e.jsx(T,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(m,{children:l?e.jsx(n,{className:"h-8 w-20"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.pendingKyc}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Verification requests"})]})})]}),x("view_transactions")&&e.jsxs(c,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Transactions"}),e.jsx(E,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(m,{children:l?e.jsx(n,{className:"h-8 w-20"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.totalTransactions}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"In the last 30 days"})]})})]}),x("view_transactions")&&e.jsxs(c,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Volume"}),e.jsx(F,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(m,{children:l?e.jsx(n,{className:"h-8 w-20"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-2xl font-bold",children:typeof t.dailyAmount=="string"?p(parseFloat(t.dailyAmount)):p(t.dailyAmount)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Transaction volume (30 days)"})]})})]})]}),x("view_analytics")&&e.jsxs(c,{className:"col-span-4",children:[e.jsxs(d,{children:[e.jsx(o,{children:"Transaction Overview"}),e.jsx(g,{children:"Transaction trends over the last 30 days"})]}),e.jsx(m,{className:"pl-2",children:l?e.jsx("div",{className:"h-[300px] flex items-center justify-center",children:e.jsx(n,{className:"h-[250px] w-full"})}):e.jsx("div",{className:"h-[300px]",children:t.chartData&&t.chartData.length>0?e.jsx(I,{width:"100%",height:"100%",children:e.jsxs(_,{data:t.chartData,children:[e.jsx(K,{strokeDasharray:"3 3"}),e.jsx(R,{dataKey:"name"}),e.jsx(b,{yAxisId:"left",orientation:"left",stroke:"#8884d8"}),e.jsx(b,{yAxisId:"right",orientation:"right",stroke:"#82ca9d"}),e.jsx(L,{}),e.jsx(w,{yAxisId:"left",dataKey:"transactions",fill:"#8884d8",name:"Transactions"}),e.jsx(w,{yAxisId:"right",dataKey:"amount",fill:"#82ca9d",name:"Amount ($)"})]})}):e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No chart data available"})})})})]}),e.jsxs(c,{className:"col-span-4",children:[e.jsxs(d,{children:[e.jsx(o,{children:"Recent Activity"}),e.jsx(g,{children:"Latest transactions and client activities"})]}),e.jsx(m,{children:l?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((s,a)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(n,{className:"h-12 w-12 rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"h-4 w-[250px]"}),e.jsx(n,{className:"h-4 w-[200px]"})]})]},a))}):e.jsx("div",{className:"space-y-4",children:t.recentActivity&&t.recentActivity.length>0?t.recentActivity.map(s=>e.jsxs("div",{className:"flex items-center gap-4 border-b pb-4",children:[e.jsx("div",{className:"rounded-full bg-primary/10 p-2",children:e.jsx(O,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.description}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(s.timestamp).toLocaleString()}),s.amount&&e.jsxs("p",{className:"text-sm font-medium",children:[p(s.amount)," ",s.currency]}),e.jsx("span",{className:`text-xs rounded-full px-2 py-0.5 ${s.status==="completed"?"bg-green-100 text-green-800":s.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.status})]})]})]},s.id)):e.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No recent activity found"})})})]})]})})}export{X as default};
